{% extends "frontend/base.html" %}
{% load static %} 
{% block title %}Iniciar Sesión{% endblock %}

{% block content %}

<section class="login-section">
  <div class="container-fluid min-vh-100 d-flex align-items-center py-5">
    <div class="row w-100 mx-0">
      
      <div class="col-12 col-md-6 d-flex justify-content-center align-items-center mb-4 mb-md-0 d-none d-md-flex">
        <img src="{% static 'principal/img/logo-sin.png' %}" alt="DVOLVE Logo" class="logo-login img-fluid" style="max-height: 400px; max-width: 80%;">
      </div>

      <div class="col-12 col-md-6 d-flex justify-content-center align-items-center">
        <div class="login-box w-100" style="max-width: 400px;">
          <h2 class="mb-2">Bienvenida a <span class="highlight" style="color: #7e2864; font-weight: bold;">DVOLVE</span></h2>
          <p class="text-muted mb-4">Entrená. Evolucioná. Conectá.</p>

          {% if error_message and not show_pay_button %}
             <div class="alert alert-danger text-center py-2 mb-3 small">
                 {{ error_message }}
             </div>
          {% endif %}

          <form method="post">
            {% csrf_token %}
            <div class="mb-3">
                <input type="text" class="form-control rounded-pill py-2 px-3" placeholder="Nombre de usuario" name="username" required>
            </div>
            <div class="mb-3">
                <input type="password" class="form-control rounded-pill py-2 px-3" placeholder="Contraseña" name="password" required>
            </div>
            <button type="submit" class="btn btn-login w-100 rounded-pill py-2 fw-bold" 
                    style="background-color: #c875ac; color: white; border: none;">
                Ingresar
            </button>
          </form>
          
          <div class="mt-3 text-center">
             <small>¿No tenés cuenta? <a href="{% url 'frontend:registro' %}" style="color: #7e2864; font-weight: 600;">Registrate</a></small>
          </div>
        </div>
      </div>

    </div>
  </div>

  {% if show_pay_button %}
  <div id="errorModal" class="modal-overlay">
    <div class="modal-dialog">
      <div class="modal-content shadow-lg">
        <div class="modal-header" style="background: linear-gradient(45deg, #7e2864, #c875ac); color: white;">
          <h5 class="modal-title fw-bold"><i class="bi bi-exclamation-circle"></i> ¡Atención!</h5>
          <button type="button" class="btn-close btn-close-white" onclick="closeModal()"></button>
        </div>
        <div class="modal-body">
          <p class="fs-5 text-dark">{{ error_message }}</p>
          <a href="{{ pay_url }}" class="btn btn-primary w-100 mt-2 rounded-pill fw-bold" style="background-color: #7e2864; border: none;">
             Elegir Plan
          </a>
        </div>
        <div class="modal-footer border-0 pt-0">
          <button type="button" class="btn btn-outline-secondary w-100 rounded-pill" onclick="closeModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* Overlay semi-transparente */
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
      display: flex; justify-content: center; align-items: center; z-index: 1050;
    }
    @media (max-width: 768px) {
        .logo-login {
            max-width: 200px; /* Más chico en celular */
            margin-bottom: 20px;
        }
    }
    .modal-dialog { max-width: 400px; width: 90%; }
    .modal-content { border-radius: 1rem; overflow: hidden; background: #fff; border: none; }
    .modal-header { padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
    .modal-body { padding: 1.5rem; text-align: center; }
    .modal-footer { padding: 1rem; }
    .btn-close { background: transparent; border: none; font-size: 1.2rem; cursor: pointer; filter: invert(1); }
  </style>

  <script>
    function closeModal() {
      document.getElementById('errorModal').style.display = 'none';
    }
  </script>
  {% endif %}

</section>
{% endblock %}